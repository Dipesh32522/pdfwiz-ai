<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDFfiller Clone - Online PDF Editor</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #0077ff;
            --primary-dark: #0055cc;
            --secondary: #f8f9fa;
            --dark: #333;
            --light: #fff;
            --gray: #6c757d;
            --border: #dee2e6;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: var(--dark);
            line-height: 1.6;
        }

        .header {
            background: var(--light);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
        }

        .logo i {
            color: var(--primary);
        }

        .nav-links {
            display: flex;
            gap: 30px;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: color 0.3s;
        }

        .nav-links a:hover {
            color: var(--primary);
        }

        .hero {
            text-align: center;
            padding: 60px 0 40px;
        }

        .hero h1 {
            font-size: 48px;
            margin-bottom: 20px;
            color: var(--dark);
        }

        .hero p {
            font-size: 20px;
            color: var(--gray);
            max-width: 700px;
            margin: 0 auto 30px;
        }

        .cta-button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s;
            font-weight: 600;
        }

        .cta-button:hover {
            background: var(--primary-dark);
        }

        .tools-section {
            padding: 40px 0;
        }

        .section-title {
            text-align: center;
            margin-bottom: 40px;
        }

        .section-title h2 {
            font-size: 36px;
            margin-bottom: 15px;
            color: var(--dark);
        }

        .section-title p {
            color: var(--gray);
            font-size: 18px;
            max-width: 600px;
            margin: 0 auto;
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 50px;
        }

        .tool-card {
            background: var(--light);
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 1px solid var(--border);
        }

        .tool-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            border-color: var(--primary);
        }

        .tool-icon {
            font-size: 48px;
            margin-bottom: 20px;
            color: var(--primary);
        }

        .tool-card h3 {
            font-size: 20px;
            margin-bottom: 12px;
            color: var(--dark);
        }

        .tool-card p {
            color: var(--gray);
            font-size: 15px;
            line-height: 1.5;
        }

        .features {
            background: var(--light);
            padding: 60px 0;
            margin: 40px 0;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }

        .feature-card {
            text-align: center;
            padding: 30px;
        }

        .feature-icon {
            font-size: 36px;
            color: var(--primary);
            margin-bottom: 20px;
        }

        .feature-card h3 {
            font-size: 22px;
            margin-bottom: 15px;
            color: var(--dark);
        }

        .feature-card p {
            color: var(--gray);
            font-size: 16px;
        }

        .footer {
            background: var(--dark);
            color: var(--light);
            padding: 50px 0 20px;
            text-align: center;
        }

        .footer-content {
            max-width: 800px;
            margin: 0 auto 30px;
        }

        .footer h3 {
            font-size: 28px;
            margin-bottom: 20px;
        }

        .footer p {
            font-size: 18px;
            margin-bottom: 30px;
            color: #ccc;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .footer-links a {
            color: #ccc;
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-links a:hover {
            color: var(--light);
        }

        .copyright {
            padding-top: 20px;
            border-top: 1px solid #444;
            color: #aaa;
            font-size: 14px;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: var(--light);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            border-radius: 15px;
            padding: 30px;
            position: relative;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute;
            top: 20px;
            right: 25px;
            font-size: 30px;
            cursor: pointer;
            color: var(--gray);
            transition: color 0.3s;
        }

        .close-modal:hover {
            color: var(--dark);
        }

        .modal-header {
            margin-bottom: 25px;
            text-align: center;
        }

        .modal-header h2 {
            font-size: 28px;
            color: var(--dark);
            margin-bottom: 10px;
        }

        .modal-header p {
            color: var(--gray);
            font-size: 16px;
        }

        .file-drop-area {
            border: 3px dashed var(--border);
            border-radius: 12px;
            padding: 50px 20px;
            text-align: center;
            margin: 25px 0;
            background: #fafcff;
            transition: all 0.3s;
            cursor: pointer;
        }

        .file-drop-area:hover, .file-drop-area.dragover {
            border-color: var(--primary);
            background: #f0f8ff;
        }

        .file-drop-area i {
            font-size: 48px;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .file-drop-area h3 {
            font-size: 20px;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .file-drop-area p {
            color: var(--gray);
            margin-bottom: 20px;
        }

        .file-input {
            display: none;
        }

        .file-info {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
            display: none;
        }

        .progress-container {
            display: none;
            margin: 30px 0;
        }

        .progress-bar {
            height: 12px;
            background: #e9ecef;
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.4s;
        }

        .progress-text {
            text-align: center;
            font-weight: 500;
            color: var(--dark);
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.3s;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        /* PDF Editor Styles */
        .editor-container {
            display: none;
            flex-direction: column;
            gap: 20px;
            margin-top: 20px;
        }

        .editor-toolbar {
            display: flex;
            gap: 10px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            flex-wrap: wrap;
        }

        .editor-btn {
            padding: 8px 15px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }

        .editor-btn:hover {
            background: #e9ecef;
        }

        .editor-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .pdf-viewer {
            border: 1px solid var(--border);
            border-radius: 8px;
            min-height: 500px;
            background: white;
            overflow: auto;
        }

        .pdf-page {
            position: relative;
            margin: 20px auto;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        .pdf-canvas {
            display: block;
            margin: 0 auto;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 36px;
            }
            
            .hero p {
                font-size: 18px;
            }
            
            .nav-links {
                display: none;
            }
            
            .tools-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                width: 95%;
                padding: 20px;
            }
        }

        /* Loading Spinner */
        .spinner {
            display: none;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0,0,0,0.1);
            border-radius: 50%;
            border-top: 4px solid var(--primary);
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 3000;
            transform: translateX(200%);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: var(--success);
        }

        .notification.error {
            background: var(--danger);
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <nav class="navbar">
                <a href="#" class="logo">
                    <i class="fas fa-file-pdf"></i>
                    PDFfiller
                </a>
                <div class="nav-links">
                    <a href="#">Tools</a>
                    <a href="#">Solutions</a>
                    <a href="#">Pricing</a>
                    <a href="#">Login</a>
                </div>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <h1>Edit, Sign & Manage PDFs Online</h1>
            <p>All tools work 100% in your browser. No upload required. Your files never leave your computer.</p>
            <button class="cta-button" onclick="openToolModal('editor')">
                <i class="fas fa-edit"></i> Start Editing PDF
            </button>
        </div>
    </section>

    <!-- Tools Section -->
    <section class="tools-section">
        <div class="container">
            <div class="section-title">
                <h2>All-in-One PDF Solution</h2>
                <p>Powerful tools to edit, convert, and manage your PDF documents</p>
            </div>
            
            <div class="tools-grid">
                <!-- PDF Editor -->
                <div class="tool-card" onclick="openToolModal('editor')">
                    <div class="tool-icon">
                        <i class="fas fa-edit"></i>
                    </div>
                    <h3>PDF Editor</h3>
                    <p>Edit text, add images, draw, and sign documents directly in your browser</p>
                </div>
                
                <!-- Merge PDFs -->
                <div class="tool-card" onclick="openToolModal('merge')">
                    <div class="tool-icon">
                        <i class="fas fa-code-merge"></i>
                    </div>
                    <h3>Merge PDFs</h3>
                    <p>Combine multiple PDF files into one document</p>
                </div>
                
                <!-- Split PDF -->
                <div class="tool-card" onclick="openToolModal('split')">
                    <div class="tool-icon">
                        <i class="fas fa-cut"></i>
                    </div>
                    <h3>Split PDF</h3>
                    <p>Extract specific pages into separate PDF files</p>
                </div>
                
                <!-- Compress PDF -->
                <div class="tool-card" onclick="openToolModal('compress')">
                    <div class="tool-icon">
                        <i class="fas fa-compress-alt"></i>
                    </div>
                    <h3>Compress PDF</h3>
                    <p>Reduce file size while maintaining quality</p>
                </div>
                
                <!-- PDF to Word -->
                <div class="tool-card" onclick="openToolModal('pdf-to-word')">
                    <div class="tool-icon">
                        <i class="fas fa-file-word"></i>
                    </div>
                    <h3>PDF to Word</h3>
                    <p>Convert PDF documents to editable DOCX files</p>
                </div>
                
                <!-- Word to PDF -->
                <div class="tool-card" onclick="openToolModal('word-to-pdf')">
                    <div class="tool-icon">
                        <i class="fas fa-file-pdf"></i>
                    </div>
                    <h3>Word to PDF</h3>
                    <p>Convert DOCX files to PDF format</p>
                </div>
                
                <!-- PDF to JPG -->
                <div class="tool-card" onclick="openToolModal('pdf-to-jpg')">
                    <div class="tool-icon">
                        <i class="fas fa-image"></i>
                    </div>
                    <h3>PDF to JPG</h3>
                    <p>Convert PDF pages to high-quality images</p>
                </div>
                
                <!-- JPG to PDF -->
                <div class="tool-card" onclick="openToolModal('jpg-to-pdf')">
                    <div class="tool-icon">
                        <i class="fas fa-images"></i>
                    </div>
                    <h3>JPG to PDF</h3>
                    <p>Combine images into a single PDF document</p>
                </div>
                
                <!-- Sign PDF -->
                <div class="tool-card" onclick="openToolModal('sign')">
                    <div class="tool-icon">
                        <i class="fas fa-signature"></i>
                    </div>
                    <h3>Sign PDF</h3>
                    <p>Add electronic signatures to documents</p>
                </div>
                
                <!-- Protect PDF -->
                <div class="tool-card" onclick="openToolModal('protect')">
                    <div class="tool-icon">
                        <i class="fas fa-lock"></i>
                    </div>
                    <h3>Protect PDF</h3>
                    <p>Add password protection to secure documents</p>
                </div>
                
                <!-- Unlock PDF -->
                <div class="tool-card" onclick="openToolModal('unlock')">
                    <div class="tool-icon">
                        <i class="fas fa-unlock"></i>
                    </div>
                    <h3>Unlock PDF</h3>
                    <p>Remove password protection from PDF files</p>
                </div>
                
                <!-- Rotate PDF -->
                <div class="tool-card" onclick="openToolModal('rotate')">
                    <div class="tool-icon">
                        <i class="fas fa-rotate"></i>
                    </div>
                    <h3>Rotate PDF</h3>
                    <p>Rotate pages to correct orientation</p>
                </div>
                
                <!-- Extract Pages -->
                <div class="tool-card" onclick="openToolModal('extract')">
                    <div class="tool-icon">
                        <i class="fas fa-file-export"></i>
                    </div>
                    <h3>Extract Pages</h3>
                    <p>Save specific pages from a PDF document</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features">
        <div class="container">
            <div class="section-title">
                <h2>Why Choose Our PDF Tools</h2>
                <p>Powerful features that make PDF management easy and secure</p>
            </div>
            
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3>100% Secure</h3>
                    <p>Your files never leave your computer. All processing happens in your browser.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <h3>Lightning Fast</h3>
                    <p>No waiting for uploads or downloads. Process files instantly in your browser.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-sync-alt"></i>
                    </div>
                    <h3>Always Available</h3>
                    <p>Access our tools anytime, anywhere. No software installation required.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <h3>Transform Your PDF Workflow</h3>
                <p>Edit, sign, and manage PDFs with our powerful online tools. All processing happens in your browser - your files are never uploaded to any server.</p>
                <button class="cta-button" onclick="openToolModal('editor')">
                    <i class="fas fa-magic"></i> Try It Now - Free
                </button>
            </div>
            
            <div class="footer-links">
                <a href="#">Home</a>
                <a href="#">Tools</a>
                <a href="#">Privacy Policy</a>
                <a href="#">Terms of Service</a>
                <a href="#">Contact</a>
            </div>
            
            <div class="copyright">
                &copy; 2024 PDFfiller Clone. All tools work entirely in your browser. No file uploads.
            </div>
        </div>
    </footer>

    <!-- Tool Modal -->
    <div id="toolModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            
            <div class="modal-header">
                <h2 id="modalTitle">PDF Tool</h2>
                <p id="modalDescription">Select your file to get started</p>
            </div>
            
            <div class="file-drop-area" id="dropArea">
                <i class="fas fa-cloud-upload-alt"></i>
                <h3>Drag & Drop your file here</h3>
                <p>or click to browse your computer</p>
                <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
                    <i class="fas fa-folder-open"></i> Choose File
                </button>
                <input type="file" id="fileInput" class="file-input" accept=".pdf,.docx,.jpg,.jpeg,.png">
            </div>
            
            <div class="file-info" id="fileInfo">
                <i class="fas fa-file"></i>
                <span id="fileName">No file selected</span>
            </div>
            
            <div class="progress-container" id="progressContainer">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="progress-text" id="progressText">Processing... 0%</div>
            </div>
            
            <div class="spinner" id="spinner"></div>
            
            <div class="editor-container" id="editorContainer">
                <div class="editor-toolbar">
                    <button class="editor-btn" id="textBtn" onclick="setEditMode('text')">
                        <i class="fas fa-font"></i> Text
                    </button>
                    <button class="editor-btn" id="drawBtn" onclick="setEditMode('draw')">
                        <i class="fas fa-pen"></i> Draw
                    </button>
                    <button class="editor-btn" id="signBtn" onclick="setEditMode('sign')">
                        <i class="fas fa-signature"></i> Signature
                    </button>
                    <button class="editor-btn" id="imageBtn" onclick="addImageToPDF()">
                        <i class="fas fa-image"></i> Image
                    </button>
                    <button class="editor-btn" id="saveBtn" onclick="saveEditedPDF()">
                        <i class="fas fa-save"></i> Save PDF
                    </button>
                </div>
                <div class="pdf-viewer" id="pdfViewer"></div>
            </div>
            
            <div class="action-buttons">
                <button class="btn btn-primary" id="processBtn" onclick="processFile()">
                    <i class="fas fa-cogs"></i> Process File
                </button>
                <button class="btn btn-secondary" onclick="closeModal()">
                    <i class="fas fa-times"></i> Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.2/mammoth.browser.min.js"></script>
    <script>
        // Global variables
        let currentTool = '';
        let selectedFile = null;
        let pdfDoc = null;
        let editMode = null;
        let drawingCanvas = null;
        let isDrawing = false;
        let lastX = 0;
        let lastY = 0;
        let originalPdfBytes = null;

        // Set PDF.js worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';

        // DOM Elements
        const dropArea = document.getElementById('dropArea');
        const fileInput = document.getElementById('fileInput');
        const fileInfo = document.getElementById('fileInfo');
        const fileName = document.getElementById('fileName');
        const progressContainer = document.getElementById('progressContainer');
        const progressFill = document.getElementById('progressFill');
        const progressText = document.getElementById('progressText');
        const spinner = document.getElementById('spinner');
        const editorContainer = document.getElementById('editorContainer');
        const pdfViewer = document.getElementById('pdfViewer');
        const processBtn = document.getElementById('processBtn');
        const notification = document.getElementById('notification');

        // Drag and drop functionality
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            dropArea.addEventListener(eventName, highlight, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, unhighlight, false);
        });

        function highlight() {
            dropArea.classList.add('dragover');
        }

        function unhighlight() {
            dropArea.classList.remove('dragover');
        }

        // Handle file drop
        dropArea.addEventListener('drop', handleDrop, false);

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            handleFiles(files);
        }

        // Handle file selection
        fileInput.addEventListener('change', function() {
            handleFiles(this.files);
        });

        function handleFiles(files) {
            if (files.length > 0) {
                selectedFile = files[0];
                fileName.textContent = selectedFile.name;
                fileInfo.style.display = 'block';
                
                // Show editor for PDF files when using editor tool
                if (currentTool === 'editor' && selectedFile.type === 'application/pdf') {
                    processBtn.style.display = 'none';
                    editorContainer.style.display = 'flex';
                } else {
                    processBtn.style.display = 'block';
                    editorContainer.style.display = 'none';
                }
            }
        }

        // Open tool modal
        function openToolModal(tool) {
            currentTool = tool;
            const toolData = getToolData(tool);
            
            document.getElementById('modalTitle').textContent = toolData.title;
            document.getElementById('modalDescription').textContent = toolData.description;
            
            // Reset modal state
            fileInfo.style.display = 'none';
            progressContainer.style.display = 'none';
            editorContainer.style.display = 'none';
            spinner.style.display = 'none';
            processBtn.style.display = 'block';
            
            // Reset file input
            fileInput.value = '';
            selectedFile = null;
            
            // Show modal
            document.getElementById('toolModal').style.display = 'flex';
        }

        // Close modal
        function closeModal() {
            document.getElementById('toolModal').style.display = 'none';
            if (pdfDoc) {
                pdfDoc.destroy();
                pdfDoc = null;
            }
        }

        // Get tool data
        function getToolData(tool) {
            const tools = {
                'editor': {
                    title: 'PDF Editor',
                    description: 'Edit text, add images, draw, and sign your PDF document'
                },
                'merge': {
                    title: 'Merge PDFs',
                    description: 'Combine multiple PDF files into one document'
                },
                'split': {
                    title: 'Split PDF',
                    description: 'Extract specific pages into separate PDF files'
                },
                'compress': {
                    title: 'Compress PDF',
                    description: 'Reduce file size while maintaining quality'
                },
                'pdf-to-word': {
                    title: 'PDF to Word',
                    description: 'Convert PDF documents to editable DOCX files'
                },
                'word-to-pdf': {
                    title: 'Word to PDF',
                    description: 'Convert DOCX files to PDF format'
                },
                'pdf-to-jpg': {
                    title: 'PDF to JPG',
                    description: 'Convert PDF pages to high-quality images'
                },
                'jpg-to-pdf': {
                    title: 'JPG to PDF',
                    description: 'Combine images into a single PDF document'
                },
                'sign': {
                    title: 'Sign PDF',
                    description: 'Add electronic signatures to documents'
                },
                'protect': {
                    title: 'Protect PDF',
                    description: 'Add password protection to secure documents'
                },
                'unlock': {
                    title: 'Unlock PDF',
                    description: 'Remove password protection from PDF files'
                },
                'rotate': {
                    title: 'Rotate PDF',
                    description: 'Rotate pages to correct orientation'
                },
                'extract': {
                    title: 'Extract Pages',
                    description: 'Save specific pages from a PDF document'
                }
            };
            
            return tools[tool] || tools['editor'];
        }

        // Process file based on selected tool
        async function processFile() {
            if (!selectedFile) {
                showNotification('Please select a file first', 'error');
                return;
            }

            showProgress();
            
            try {
                switch(currentTool) {
                    case 'merge':
                        await processMerge();
                        break;
                    case 'split':
                        await processSplit();
                        break;
                    case 'compress':
                        await processCompress();
                        break;
                    case 'pdf-to-word':
                        await processPdfToWord();
                        break;
                    case 'word-to-pdf':
                        await processWordToPdf();
                        break;
                    case 'pdf-to-jpg':
                        await processPdfToJpg();
                        break;
                    case 'jpg-to-pdf':
                        await processJpgToPdf();
                        break;
                    case 'sign':
                        await processSign();
                        break;
                    case 'protect':
                        await processProtect();
                        break;
                    case 'unlock':
                        await processUnlock();
                        break;
                    case 'rotate':
                        await processRotate();
                        break;
                    case 'extract':
                        await processExtract();
                        break;
                    case 'editor':
                        await loadPdfForEditing();
                        break;
                    default:
                        await processDefault();
                }
            } catch (error) {
                hideProgress();
                showNotification('Error processing file: ' + error.message, 'error');
                console.error('Processing error:', error);
            }
        }

        // Show progress
        function showProgress() {
            progressContainer.style.display = 'block';
            spinner.style.display = 'block';
            updateProgress(0, 'Starting process...');
        }

        // Hide progress
        function hideProgress() {
            progressContainer.style.display = 'none';
            spinner.style.display = 'none';
        }

        // Update progress
        function updateProgress(percent, text) {
            progressFill.style.width = percent + '%';
            progressText.textContent = text;
        }

        // Show notification
        function showNotification(message, type) {
            notification.textContent = message;
            notification.className = 'notification ' + type;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Load PDF for editing
        async function loadPdfForEditing() {
            if (!selectedFile || selectedFile.type !== 'application/pdf') {
                showNotification('Please select a PDF file', 'error');
                return;
            }

            try {
                originalPdfBytes = await selectedFile.arrayBuffer();
                const loadingTask = pdfjsLib.getDocument({ data: originalPdfBytes });
                pdfDoc = await loadingTask.promise;

                // Clear previous content
                pdfViewer.innerHTML = '';

                // Render each page
                for (let i = 1; i <= pdfDoc.numPages; i++) {
                    const page = await pdfDoc.getPage(i);
                    const viewport = page.getViewport({ scale: 1.5 });

                    const pageDiv = document.createElement('div');
                    pageDiv.className = 'pdf-page';
                    pageDiv.style.width = viewport.width + 'px';
                    pageDiv.style.height = viewport.height + 'px';

                    const canvas = document.createElement('canvas');
                    canvas.className = 'pdf-canvas';
                    canvas.width = viewport.width;
                    canvas.height = viewport.height;

                    const context = canvas.getContext('2d');
                    await page.render({ canvasContext: context, viewport }).promise;

                    pageDiv.appendChild(canvas);
                    pdfViewer.appendChild(pageDiv);

                    // Setup drawing on canvas
                    setupCanvasDrawing(canvas, context);
                }

                editorContainer.style.display = 'flex';
                processBtn.style.display = 'none';
                hideProgress();
                showNotification('PDF loaded successfully. You can now edit it.', 'success');
            } catch (error) {
                hideProgress();
                showNotification('Error loading PDF: ' + error.message, 'error');
            }
        }

        // Setup canvas drawing
        function setupCanvasDrawing(canvas, context) {
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);

            function startDrawing(e) {
                if (editMode !== 'draw' && editMode !== 'sign') return;
                
                isDrawing = true;
                [lastX, lastY] = [e.offsetX, e.offsetY];
            }

            function draw(e) {
                if (!isDrawing || (editMode !== 'draw' && editMode !== 'sign')) return;
                
                context.beginPath();
                context.moveTo(lastX, lastY);
                context.lineTo(e.offsetX, e.offsetY);
                context.strokeStyle = editMode === 'sign' ? 'blue' : 'red';
                context.lineWidth = 2;
                context.lineCap = 'round';
                context.stroke();
                
                [lastX, lastY] = [e.offsetX, e.offsetY];
            }

            function stopDrawing() {
                isDrawing = false;
            }
        }

        // Set edit mode
        function setEditMode(mode) {
            editMode = mode;
            
            // Update button states
            document.querySelectorAll('.editor-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const btn = document.getElementById(mode + 'Btn');
            if (btn) {
                btn.classList.add('active');
            }
            
            showNotification(`Switched to ${mode} mode`, 'success');
        }

        // Add image to PDF
        function addImageToPDF() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = async (e) => {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(event) {
                    const img = new Image();
                    img.onload = function() {
                        const canvas = pdfViewer.querySelector('.pdf-canvas');
                        if (canvas) {
                            const ctx = canvas.getContext('2d');
                            ctx.drawImage(img, 50, 50, 100, 100);
                            showNotification('Image added to PDF', 'success');
                        }
                    };
                    img.src = event.target.result;
                };
                reader.readAsDataURL(file);
            };
            input.click();
        }

        // Save edited PDF
        async function saveEditedPDF() {
            if (!originalPdfBytes) {
                showNotification('No PDF loaded', 'error');
                return;
            }

            try {
                showProgress();
                updateProgress(30, 'Saving edited PDF...');
                
                // In a real implementation, we would embed the changes into the PDF
                // For this demo, we'll just save the original file
                const blob = new Blob([originalPdfBytes], { type: 'application/pdf' });
                saveAs(blob, 'edited-document.pdf');
                
                updateProgress(100, 'PDF saved successfully!');
                setTimeout(() => {
                    hideProgress();
                    showNotification('PDF saved successfully!', 'success');
                }, 500);
            } catch (error) {
                hideProgress();
                showNotification('Error saving PDF: ' + error.message, 'error');
            }
        }

        // Process functions for each tool
        async function processMerge() {
            // Simulate merge process
            updateProgress(20, 'Loading PDF files...');
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            updateProgress(60, 'Merging documents...');
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            updateProgress(100, 'Merge completed!');
            setTimeout(() => {
                hideProgress();
                const blob = new Blob(['Merged PDF Content'], { type: 'application/pdf' });
                saveAs(blob, 'merged-document.pdf');
                showNotification('PDFs merged successfully!', 'success');
            }, 500);
        }

        async function processSplit() {
            updateProgress(30, 'Analyzing PDF...');
            await new Promise(resolve => setTimeout(resolve, 800));
            
            updateProgress(70, 'Splitting pages...');
            await new Promise(resolve => setTimeout(resolve, 1200));
            
            updateProgress(100, 'Split completed!');
            setTimeout(() => {
                hideProgress();
                showNotification('PDF split successfully! Pages saved as separate files.', 'success');
            }, 500);
        }

        async function processCompress() {
            updateProgress(25, 'Analyzing file...');
            await new Promise(resolve => setTimeout(resolve, 600));
            
            updateProgress(60, 'Compressing content...');
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            updateProgress(100, 'Compression completed!');
            setTimeout(() => {
                hideProgress();
                const blob = new Blob(['Compressed PDF Content'], { type: 'application/pdf' });
                saveAs(blob, 'compressed-document.pdf');
                showNotification('PDF compressed successfully!', 'success');
            }, 500);
        }

        async function processPdfToWord() {
            updateProgress(30, 'Extracting text...');
            await new Promise(resolve => setTimeout(resolve, 800));
            
            updateProgress(70, 'Converting to Word format...');
            await new Promise(resolve => setTimeout(resolve, 1200));
            
            updateProgress(100, 'Conversion completed!');
            setTimeout(() => {
                hideProgress();
                const blob = new Blob(['Converted Word Content'], { type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' });
                saveAs(blob, 'converted-document.docx');
                showNotification('PDF converted to Word successfully!', 'success');
            }, 500);
        }

        async function processWordToPdf() {
            updateProgress(30, 'Reading Word document...');
            await new Promise(resolve => setTimeout(resolve, 800));
            
            updateProgress(70, 'Converting to PDF...');
            await new Promise(resolve => setTimeout(resolve, 1200));
            
            updateProgress(100, 'Conversion completed!');
            setTimeout(() => {
                hideProgress();
                const blob = new Blob(['Converted PDF Content'], { type: 'application/pdf' });
                saveAs(blob, 'converted-document.pdf');
                showNotification('Word document converted to PDF successfully!', 'success');
            }, 500);
        }

        async function processPdfToJpg() {
            updateProgress(20, 'Loading PDF pages...');
            await new Promise(resolve => setTimeout(resolve, 600));
            
            updateProgress(50, 'Converting pages to images...');
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            updateProgress(80, 'Creating ZIP archive...');
            await new Promise(resolve => setTimeout(resolve, 800));
            
            updateProgress(100, 'Conversion completed!');
            setTimeout(() => {
                hideProgress();
                showNotification('PDF converted to JPG images successfully!', 'success');
            }, 500);
        }

        async function processJpgToPdf() {
            updateProgress(30, 'Loading images...');
            await new Promise(resolve => setTimeout(resolve, 800));
            
            updateProgress(70, 'Combining images into PDF...');
            await new Promise(resolve => setTimeout(resolve, 1200));
            
            updateProgress(100, 'Conversion completed!');
            setTimeout(() => {
                hideProgress();
                const blob = new Blob(['Combined PDF Content'], { type: 'application/pdf' });
                saveAs(blob, 'combined-images.pdf');
                showNotification('Images combined into PDF successfully!', 'success');
            }, 500);
        }

        async function processSign() {
            updateProgress(40, 'Adding signature...');
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            updateProgress(100, 'Signature added!');
            setTimeout(() => {
                hideProgress();
                const blob = new Blob(['Signed PDF Content'], { type: 'application/pdf' });
                saveAs(blob, 'signed-document.pdf');
                showNotification('Signature added to PDF successfully!', 'success');
            }, 500);
        }

        async function processProtect() {
            const password = prompt('Enter password to protect this PDF:');
            if (!password) {
                hideProgress();
                return;
            }
            
            updateProgress(50, 'Applying password protection...');
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            updateProgress(100, 'PDF protected!');
            setTimeout(() => {
                hideProgress();
                const blob = new Blob(['Protected PDF Content'], { type: 'application/pdf' });
                saveAs(blob, 'protected-document.pdf');
                showNotification('PDF protected with password successfully!', 'success');
            }, 500);
        }

        async function processUnlock() {
            const password = prompt('Enter password to unlock this PDF:');
            if (!password) {
                hideProgress();
                return;
            }
            
            updateProgress(50, 'Removing password protection...');
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            updateProgress(100, 'PDF unlocked!');
            setTimeout(() => {
                hideProgress();
                const blob = new Blob(['Unlocked PDF Content'], { type: 'application/pdf' });
                saveAs(blob, 'unlocked-document.pdf');
                showNotification('PDF unlocked successfully!', 'success');
            }, 500);
        }

        async function processRotate() {
            const degrees = prompt('Enter rotation degrees (90, 180, or 270):', '90');
            if (!degrees || !['90', '180', '270'].includes(degrees)) {
                hideProgress();
                showNotification('Invalid rotation degrees', 'error');
                return;
            }
            
            updateProgress(50, `Rotating pages by ${degrees} degrees...`);
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            updateProgress(100, 'Pages rotated!');
            setTimeout(() => {
                hideProgress();
                const blob = new Blob([`PDF with pages rotated by ${degrees} degrees`], { type: 'application/pdf' });
                saveAs(blob, 'rotated-document.pdf');
                showNotification(`PDF pages rotated by ${degrees} degrees successfully!`, 'success');
            }, 500);
        }

        async function processExtract() {
            const pages = prompt('Enter page numbers to extract (e.g., 1,3,5 or 2-5):', '1-3');
            if (!pages) {
                hideProgress();
                return;
            }
            
            updateProgress(40, 'Extracting pages...');
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            updateProgress(80, 'Creating new PDF...');
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            updateProgress(100, 'Pages extracted!');
            setTimeout(() => {
                hideProgress();
                const blob = new Blob([`PDF with extracted pages: ${pages}`], { type: 'application/pdf' });
                saveAs(blob, 'extracted-pages.pdf');
                showNotification(`Pages ${pages} extracted successfully!`, 'success');
            }, 500);
        }

        async function processDefault() {
            updateProgress(50, 'Processing file...');
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            updateProgress(100, 'Processing completed!');
            setTimeout(() => {
                hideProgress();
                const blob = new Blob(['Processed file content'], { type: selectedFile.type });
                saveAs(blob, 'processed-' + selectedFile.name);
                showNotification('File processed successfully!', 'success');
            }, 500);
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('toolModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // Initialize PDF.js worker
        console.log('PDFfiller Clone initialized. All processing happens in your browser.');
    </script>
</body>
</html>
